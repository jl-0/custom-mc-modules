<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unity Terraform Modules - Documentation</title>
    <meta name="description" content="Official Terraform module registry for the Unity Science Data System (SDS)">
    <meta name="keywords" content="Unity, SDS, Terraform, AWS, Infrastructure, Modules">
    <meta name="author" content="Unity SDS Team">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Unity Terraform Modules">
    <meta property="og:description" content="Reusable Terraform modules for Unity SDS applications">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://unity-sds.github.io/unity-terraform-modules">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Unity Terraform Modules">
    <meta name="twitter:description" content="Reusable Terraform modules for Unity SDS applications">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" href="/favicon.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
        :root {
            --unity-blue: #1e40af;
            --unity-blue-light: #3b82f6;
            --unity-blue-dark: #1e3a8a;
            --unity-gray: #64748b;
            --unity-gray-light: #f8fafc;
            --unity-gray-dark: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #334155;
            background-color: #ffffff;
        }
        
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        /* Loading screen */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 1.5rem;
            color: var(--unity-blue);
        }
        
        .loading.hidden {
            display: none;
        }
        
        /* App content */
        .app {
            display: none;
        }
        
        .app.loaded {
            display: block;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--unity-blue) 0%, var(--unity-blue-dark) 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* Navigation */
        .nav {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 100;
            margin-bottom: 2rem;
        }
        
        .nav-container {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            gap: 2rem;
        }
        
        .nav-links {
            display: flex;
            gap: 1.5rem;
            list-style: none;
        }
        
        .nav-links a {
            color: var(--unity-gray);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .nav-links a:hover,
        .nav-links a.active {
            color: var(--unity-blue);
        }
        
        /* Main content */
        .main {
            min-height: calc(100vh - 200px);
        }
        
        /* Module grid */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .module-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .module-card:hover {
            border-color: var(--unity-blue-light);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.1);
            transform: translateY(-2px);
        }
        
        .module-card h3 {
            color: var(--unity-blue);
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .module-card p {
            color: var(--unity-gray);
            margin-bottom: 1rem;
        }
        
        .module-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .tag {
            background: var(--unity-gray-light);
            color: var(--unity-gray-dark);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        /* Code blocks */
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
        }
        
        :not(pre) > code {
            background: #f1f5f9;
            color: #e11d48;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }
        
        /* Footer */
        .footer {
            background: var(--unity-gray-light);
            padding: 2rem 0;
            margin-top: 4rem;
            text-align: center;
            color: var(--unity-gray);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .module-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        Loading Unity Terraform Modules...
    </div>
    
    <div class="app" id="app">
        <header class="header">
            <div class="container">
                <h1>Unity Terraform Modules</h1>
                <p>Reusable infrastructure components for Unity Science Data System</p>
            </div>
        </header>
        
        <nav class="nav">
            <div class="container">
                <div class="nav-container">
                    <ul class="nav-links">
                        <li><a href="#overview" class="nav-link active">Overview</a></li>
                        <li><a href="#modules" class="nav-link">Modules</a></li>
                        <li><a href="#quickstart" class="nav-link">Quick Start</a></li>
                        <li><a href="#registry" class="nav-link">Registry</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <main class="main">
            <div class="container">
                <div id="content">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <div class="container">
                <p>&copy; 2025 Unity Science Data System - Jet Propulsion Laboratory, California Institute of Technology</p>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        // Application state
        let moduleRegistry = null;
        let moduleReadmes = {};
        let currentPage = 'overview';
        
        // Initialize the application
        async function init() {
            try {
                // Load module registry
                const response = await fetch('../module-registry.json');
                moduleRegistry = await response.json();
                
                // Load README files for each module
                await loadModuleReadmes();
                
                // Initialize routing
                initRouting();
                
                // Load initial page
                loadPage(getPageFromHash());
                
                // Hide loading screen
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('app').classList.add('loaded');
                
            } catch (error) {
                console.error('Failed to load module registry:', error);
                document.getElementById('loading').innerHTML = 'Failed to load module registry. Please try again later.';
            }
        }
        
        // Load README files for all modules
        async function loadModuleReadmes() {
            const loadPromises = Object.entries(moduleRegistry.modules).map(async ([moduleName, moduleData]) => {
                try {
                    // Extract module path from source
                    const modulePath = getModulePathFromSource(moduleData.source);
                    const readmeUrl = `https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/${modulePath}/README.md`;
                    
                    const response = await fetch(readmeUrl);
                    if (response.ok) {
                        const readmeContent = await response.text();
                        moduleReadmes[moduleName] = readmeContent;
                    } else {
                        console.warn(`Failed to load README for ${moduleName}:`, response.status);
                        moduleReadmes[moduleName] = null;
                    }
                } catch (error) {
                    console.warn(`Error loading README for ${moduleName}:`, error);
                    moduleReadmes[moduleName] = null;
                }
            });
            
            await Promise.all(loadPromises);
        }
        
        // Extract module path from source URL
        function getModulePathFromSource(source) {
            // Convert "github.com/jl-0/custom-mc-modules//modules/s3" to "modules/s3"
            const parts = source.split('//');
            return parts.length > 1 ? parts[1] : 'modules/' + source.split('/').pop();
        }
        
        // Routing
        function initRouting() {
            window.addEventListener('hashchange', () => {
                const page = getPageFromHash();
                loadPage(page);
            });
            
            // Navigation links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = link.getAttribute('href').substring(1);
                    window.location.hash = page;
                });
            });
        }
        
        function getPageFromHash() {
            const hash = window.location.hash.substring(1);
            return hash || 'overview';
        }
        
        function loadPage(page) {
            currentPage = page;
            updateActiveNavLink();
            
            const content = document.getElementById('content');
            
            switch (page) {
                case 'overview':
                    content.innerHTML = renderOverview();
                    break;
                case 'modules':
                    content.innerHTML = renderModules();
                    break;
                case 'quickstart':
                    content.innerHTML = renderQuickStart();
                    break;
                case 'registry':
                    content.innerHTML = renderRegistry();
                    break;
                default:
                    if (page.startsWith('module-')) {
                        const moduleName = page.replace('module-', '');
                        content.innerHTML = renderModuleDetail(moduleName);
                    } else {
                        content.innerHTML = renderOverview();
                    }
            }
            
            // Re-run Prism highlighting
            if (window.Prism) {
                Prism.highlightAll();
            }
        }
        
        function updateActiveNavLink() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + currentPage) {
                    link.classList.add('active');
                }
            });
        }
        
        // Page renderers
        function renderOverview() {
            return `
                <div class="prose max-w-none">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="color: var(--unity-blue); font-size: 2rem; margin: 0;">Overview</h2>
                        <button onclick="copyPageMarkdown('overview', this)" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">üìã Copy Markdown</button>
                    </div>
                    
                    <p style="font-size: 1.125rem; margin-bottom: 2rem;">
                        Unity Terraform Modules provide reusable infrastructure components designed specifically for 
                        Unity Science Data System applications. These modules follow Unity best practices for security, 
                        tagging, monitoring, and cost optimization.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                        <div style="background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                            <h3 style="margin-bottom: 0.5rem;">üîí Security First</h3>
                            <p style="opacity: 0.9;">All modules implement security best practices by default</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                            <h3 style="margin-bottom: 0.5rem;">üè∑Ô∏è Consistent Tagging</h3>
                            <p style="opacity: 0.9;">Standardized tagging for cost tracking and resource management</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                            <h3 style="margin-bottom: 0.5rem;">üìä Monitoring Ready</h3>
                            <p style="opacity: 0.9;">Built-in CloudWatch monitoring and logging capabilities</p>
                        </div>
                        <div style="background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                            <h3 style="margin-bottom: 0.5rem;">üîß Unity Integration</h3>
                            <p style="opacity: 0.9;">Seamless integration with Unity Management Console</p>
                        </div>
                    </div>
                    
                    <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Module Registry Usage</h3>
                    <p style="margin-bottom: 1rem;">Reference modules through the Unity Management Console using standard Terraform syntax:</p>
                    
                    <pre><code class="language-hcl"># Create a secure S3 bucket with Unity best practices
module "data_bucket" {
  source  = "my-unity-console.com/unity/s3/aws"
  version = "~> 1.0"

  bucket_name = "unity-example-bucket"
  environment = "dev"
  project     = "unity"
  
  enable_standard_lifecycle = true
}

# Create VPC with public and private subnets
module "network" {
  source  = "my-unity-console.com/unity/vpc/aws"
  version = "~> 1.0"

  vpc_cidr           = "10.0.0.0/16"
  name_prefix        = "unity-dev"
  availability_zones = ["us-west-2a", "us-west-2b"]
}</code></pre>
                    
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid var(--unity-blue); margin: 2rem 0;">
                        <h4 style="color: var(--unity-blue); margin-bottom: 0.5rem;">üí° Integration with Unity Management Console</h4>
                        <p style="margin-bottom: 0;">
                            These modules are designed to work seamlessly with the 
                            <a href="https://github.com/unity-sds/unity-management-console" style="color: var(--unity-blue);">Unity Management Console</a>. 
                            The console can automatically discover and use these modules through the module registry.
                        </p>
                    </div>
                    
                    <div style="background: #f0f9ff; padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid #0ea5e9; margin: 2rem 0;">
                        <h4 style="color: #0369a1; margin-bottom: 1rem;">ü§ñ For AI Assistants & LLMs</h4>
                        <p style="margin-bottom: 1rem;">
                            This documentation is optimized for Large Language Models and AI assistants. 
                            Every page includes a "Copy Markdown" button (üìã) in the top-right corner that generates 
                            structured, LLM-friendly documentation for that specific page.
                        </p>
                        
                        <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #bae6fd; margin-bottom: 1rem;">
                            <h5 style="color: #0369a1; margin-bottom: 0.5rem;">üìù How to Use Copy Markdown</h5>
                            <ol style="margin-left: 1.5rem; line-height: 1.6;">
                                <li>Navigate to any page (Overview, Modules, Quick Start, Registry, or specific module)</li>
                                <li>Click the "üìã Copy Markdown" button in the top-right corner</li>
                                <li>Paste the copied markdown into your AI conversation for context</li>
                                <li>Ask the AI to help implement, explain, or work with these Terraform modules</li>
                            </ol>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                            <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #bae6fd;">
                                <h5 style="color: #0369a1; margin-bottom: 0.5rem;">üìã Page-Specific Content</h5>
                                <p style="margin-bottom: 0.5rem; font-size: 0.9rem;">Each page generates tailored markdown with relevant examples, inputs, outputs, and usage patterns</p>
                                <small style="color: #64748b;">Perfect for focused AI conversations</small>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #bae6fd;">
                                <h5 style="color: #0369a1; margin-bottom: 0.5rem;">üîó Direct Access URLs</h5>
                                <p style="margin-bottom: 0.5rem; font-size: 0.9rem;">
                                    <a href="https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/docs/llm-documentation.md" style="color: var(--unity-blue);">Complete LLM Docs (Markdown)</a><br>
                                    <a href="https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json" style="color: var(--unity-blue);">Module Registry (JSON)</a>
                                </p>
                                <small style="color: #64748b;">For automated tools and direct AI access</small>
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
                            <p style="margin: 0; font-size: 0.9rem; color: #64748b;">
                                üí° <strong>Tip:</strong> For comprehensive module documentation, visit individual module pages and copy their markdown. 
                                For quick overviews, use the Overview or Modules page copy buttons.
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderModules() {
            if (!moduleRegistry) return '<p>Loading modules...</p>';
            
            const modules = Object.entries(moduleRegistry.modules);
            
            let html = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2 style="color: var(--unity-blue); font-size: 2rem; margin: 0;">Available Modules</h2>
                    <button onclick="copyPageMarkdown('modules', this)" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">üìã Copy Markdown</button>
                </div>
                
                <p style="color: var(--unity-gray); margin-bottom: 2rem;">
                    These modules are designed for use with the Unity Management Console and follow standard Terraform Registry Protocol.
                </p>
                
                <div class="module-grid">
            `;
            
            modules.forEach(([moduleName, moduleData]) => {
                // Extract provider from module name or source
                const provider = getProviderFromModule(moduleName, moduleData.source);
                const registryPath = `my-unity-console.com/${moduleName.replace('-', '/')}/${provider}`;
                
                html += `
                    <div class="module-card" onclick="window.location.hash = 'module-${moduleName}'">
                        <h3>${moduleName}</h3>
                        <p>${moduleData.description}</p>
                        <div style="margin-top: 1rem;">
                            <div style="background: #f1f5f9; padding: 0.5rem; border-radius: 0.25rem; margin-bottom: 0.5rem;">
                                <code style="font-size: 0.8rem;">${registryPath}</code>
                            </div>
                            ${moduleData.documentation ? `<a href="${moduleData.documentation}" style="color: var(--unity-blue); font-size: 0.9rem;">üìñ Documentation</a>` : ''}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            return html;
        }
        
        // Extract provider from module name or infer from source
        function getProviderFromModule(moduleName, source) {
            // For now, assume AWS since these are Unity modules
            // In a real implementation, you might parse the versions.tf file
            return 'aws';
        }
        
        function renderQuickStart() {
            if (!moduleRegistry) return '<p>Loading...</p>';
            
            return `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2 style="color: var(--unity-blue); font-size: 2rem; margin: 0;">Quick Start</h2>
                    <button onclick="copyPageMarkdown('quickstart', this)" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">üìã Copy Markdown</button>
                </div>
                
                <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 2rem;">
                    <h3 style="color: var(--unity-blue); margin-bottom: 1rem;">Getting Started with Unity Management Console</h3>
                    <ol style="margin-left: 1.5rem; line-height: 1.8;">
                        <li>Set up the Unity Management Console with module registry</li>
                        <li>Choose a module from the registry below</li>
                        <li>Reference the module in your Terraform configuration using standard registry syntax</li>
                        <li>Configure the required inputs for your use case</li>
                        <li>Run <code>terraform init</code> and <code>terraform apply</code></li>
                    </ol>
                </div>
                
                <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Module Registry Usage</h3>
                <p style="margin-bottom: 1rem;">The Unity Management Console acts as a Terraform Module Registry. Reference modules using standard Terraform syntax:</p>
                
                <pre><code class="language-hcl"># Basic S3 bucket
module "data_bucket" {
  source  = "my-unity-console.com/unity/s3/aws"
  version = "~> 1.0"
  
  bucket_name = "my-unity-data-bucket"
  environment = "dev"
  project     = "unity"
}

# VPC with subnets
module "network" {
  source  = "my-unity-console.com/unity/vpc/aws"
  version = "~> 1.0"
  
  vpc_cidr           = "10.0.0.0/16"
  name_prefix        = "my-unity"
  availability_zones = ["us-west-2a", "us-west-2b"]
}</code></pre>
                
                <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Module Registry Configuration</h3>
                <p style="margin-bottom: 1rem;">The Management Console loads modules from this registry configuration:</p>
                
                <pre><code class="language-bash"># Registry URL
https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json

# Local registry file location
~/.unity/workdir/module-registry.json</code></pre>

                <div style="background: #f0f9ff; padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid #0ea5e9; margin: 2rem 0;">
                    <h4 style="color: #0369a1; margin-bottom: 1rem;">üöÄ How It Works</h4>
                    <ol style="margin-left: 1.5rem; line-height: 1.6;">
                        <li><strong>Module Registry</strong>: Management Console loads module definitions</li>
                        <li><strong>Terraform Registry API</strong>: Exposes standard Terraform Registry Protocol endpoints</li>
                        <li><strong>Standard Workflow</strong>: Use modules with normal <code>terraform</code> commands</li>
                        <li><strong>Automatic Caching</strong>: Modules are downloaded and cached automatically</li>
                    </ol>
                </div>
            `;
        }
        
        
        // Helper function to generate example values based on type and name
        function getExampleValue(type, name) {
            if (name.includes('cidr')) return '"10.0.0.0/16"';
            if (name.includes('zone')) return '["us-west-2a", "us-west-2b"]';
            if (name.includes('bucket')) return '"my-app-data-bucket"';
            if (name.includes('prefix') || name.includes('name')) return '"my-app"';
            if (name.includes('environment')) return '"dev"';
            if (name.includes('project')) return '"unity"';
            
            switch (type) {
                case 'string': return '"example-value"';
                case 'bool': return 'true';
                case 'number': return '20';
                case 'list(string)': return '["example1", "example2"]';
                case 'map(string)': return '{ key = "value" }';
                default: return '"example"';
            }
        }
        
        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Function to copy markdown to clipboard
        function copyMarkdownToClipboard(buttonElement, textElementId) {
            const textElement = textElementId ? document.getElementById(textElementId) : document.getElementById('llm-markdown');
            const text = textElement.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // Show temporary success message
                const button = buttonElement || event.target;
                const originalText = button.textContent;
                button.textContent = '‚úÖ Copied!';
                button.style.background = '#059669';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = 'var(--unity-blue)';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard. Please select and copy the text manually.');
            });
        }
        
        // Function to generate markdown for any page
        function generatePageMarkdown(page, moduleData = null) {
            let markdown = '';
            
            switch (page) {
                case 'overview':
                    markdown = `# Unity Terraform Modules - Overview

Unity Terraform Modules provide reusable infrastructure components designed specifically for Unity Science Data System applications. These modules follow Unity best practices for security, tagging, monitoring, and cost optimization.

## Key Features

- **Security First**: All modules implement security best practices by default
- **Consistent Tagging**: Standardized tagging for cost tracking and resource management  
- **Monitoring Ready**: Built-in CloudWatch monitoring and logging capabilities
- **Unity Integration**: Seamless integration with Unity Management Console

## Module Registry Usage

The Unity Management Console acts as a Terraform Module Registry. Reference modules using standard Terraform syntax:

\`\`\`hcl
# Basic S3 bucket
module "data_bucket" {
  source  = "my-unity-console.com/unity/s3/aws"
  version = "~> 1.0"
  
  bucket_name = "my-unity-data-bucket"
  environment = "dev"
  project     = "unity"
}

# VPC with subnets
module "network" {
  source  = "my-unity-console.com/unity/vpc/aws"
  version = "~> 1.0"
  
  vpc_cidr           = "10.0.0.0/16"
  name_prefix        = "my-unity"
  availability_zones = ["us-west-2a", "us-west-2b"]
}
\`\`\`

## Repository

**URL**: https://github.com/jl-0/custom-mc-modules
**Documentation**: https://jl-0.github.io/custom-mc-modules
**Registry JSON**: https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json`;
                    break;
                    
                case 'modules':
                    markdown = `# Unity Terraform Modules - Available Modules

`;
                    if (moduleRegistry?.modules) {
                        Object.entries(moduleRegistry.modules).forEach(([moduleName, moduleInfo]) => {
                            const provider = getProviderFromModule(moduleName, moduleInfo.source);
                            const registryPath = `my-unity-console.com/${moduleName.replace('-', '/')}/${provider}`;
                            
                            markdown += `## ${moduleName}

**Description**: ${moduleInfo.description}
**Registry Path**: \`${registryPath}\`
**Source**: \`${moduleInfo.source}\`
${moduleInfo.documentation ? `**Documentation**: ${moduleInfo.documentation}` : ''}

`;
                        });
                    }
                    break;
                    
                case 'quickstart':
                    markdown = `# Unity Terraform Modules - Quick Start

## Getting Started with Unity Management Console

1. Set up the Unity Management Console with module registry
2. Choose a module from the registry below
3. Reference the module in your Terraform configuration using standard registry syntax
4. Configure the required inputs for your use case
5. Run \`terraform init\` and \`terraform apply\`

## Module Registry Usage

The Unity Management Console acts as a Terraform Module Registry. Reference modules using standard Terraform syntax:

\`\`\`hcl
# Basic S3 bucket
module "data_bucket" {
  source  = "my-unity-console.com/unity/s3/aws"
  version = "~> 1.0"
  
  bucket_name = "my-unity-data-bucket"
  environment = "dev"
  project     = "unity"
}

# VPC with subnets
module "network" {
  source  = "my-unity-console.com/unity/vpc/aws"
  version = "~> 1.0"
  
  vpc_cidr           = "10.0.0.0/16"
  name_prefix        = "my-unity"
  availability_zones = ["us-west-2a", "us-west-2b"]
}
\`\`\`

## Module Registry Configuration

The Management Console loads modules from this registry configuration:

\`\`\`bash
# Registry URL
https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json

# Local registry file location
~/.unity/workdir/module-registry.json
\`\`\``;
                    break;
                    
                case 'registry':
                    markdown = `# Unity Terraform Modules - Registry Information

**Name**: ${moduleRegistry?.metadata?.name || 'Unity Terraform Modules Registry'}
**Description**: ${moduleRegistry?.metadata?.description || ''}
**Last Updated**: ${moduleRegistry?.metadata?.last_updated || ''}

## Registry URL

\`\`\`
https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json
\`\`\`

## Registry Data

\`\`\`json
${JSON.stringify(moduleRegistry, null, 2)}
\`\`\``;
                    break;
                    
                default:
                    if (page.startsWith('module-') && moduleData) {
                        const moduleName = page.replace('module-', '');
                        const provider = getProviderFromModule(moduleName, moduleData.source);
                        const registryPath = `my-unity-console.com/${moduleName.replace('-', '/')}/${provider}`;
                        const readme = moduleReadmes[moduleName];
                        
                        markdown = `# ${moduleName}

**Description**: ${moduleData.description}
**Registry Path**: \`${registryPath}\`
**Source**: \`${moduleData.source}\`
${moduleData.documentation ? `**Documentation**: ${moduleData.documentation}` : ''}

## Usage Example

\`\`\`hcl
module "${moduleName.replace('unity-', '')}" {
  source  = "${registryPath}"
  version = "~> 1.0"
  
  # Required inputs${generateExampleInputs(moduleData.inputs)}
}
\`\`\`

`;
                        
                        // Include README content if available
                        if (readme) {
                            markdown += `## Module Documentation

${readme}

`;
                        }
                        
                        markdown += `## Inputs

| Name | Description | Type | Required | Default |
|------|-------------|------|----------|----------|
`;
                        if (moduleData.inputs) {
                            Object.entries(moduleData.inputs).forEach(([name, input]) => {
                                const defaultVal = input.default !== undefined ? `\`${JSON.stringify(input.default)}\`` : '-';
                                markdown += `| \`${name}\` | ${input.description} | \`${input.type}\` | ${input.required ? 'Yes' : 'No'} | ${defaultVal} |\n`;
                            });
                        }
                        
                        markdown += `
## Outputs

| Name | Description |
|------|-------------|
`;
                        if (moduleData.outputs) {
                            Object.entries(moduleData.outputs).forEach(([name, outputData]) => {
                                const description = typeof outputData === 'string' ? outputData : outputData.description;
                                markdown += `| \`${name}\` | ${description} |\n`;
                            });
                        }
                    }
                    break;
            }
            
            return markdown;
        }
        
        function renderRegistry() {
            if (!moduleRegistry) return '<p>Loading...</p>';
            
            return `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2 style="color: var(--unity-blue); font-size: 2rem; margin: 0;">Module Registry</h2>
                    <button onclick="copyPageMarkdown('registry', this)" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">üìã Copy Markdown</button>
                </div>
                
                <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 2rem;">
                    <h3 style="color: var(--unity-blue); margin-bottom: 1rem;">Registry Information</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li><strong>Name:</strong> ${moduleRegistry.metadata.name}</li>
                        <li><strong>Description:</strong> ${moduleRegistry.metadata.description}</li>
                        <li><strong>Last Updated:</strong> ${new Date(moduleRegistry.metadata.last_updated).toLocaleString()}</li>
                        <li><strong>Repository:</strong> <a href="${moduleRegistry.metadata.repository}" style="color: var(--unity-blue);">${moduleRegistry.metadata.repository}</a></li>
                    </ul>
                </div>
                
                <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Registry URL</h3>
                <p style="margin-bottom: 1rem;">Use this URL to access the module registry directly:</p>
                
                <pre><code>https://raw.githubusercontent.com/jl-0/custom-mc-modules/main/module-registry.json</code></pre>
                
                <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Raw Registry Data</h3>
                <pre><code class="language-json">${JSON.stringify(moduleRegistry, null, 2)}</code></pre>
            `;
        }
        
        function renderModuleDetail(moduleName) {
            if (!moduleRegistry) return '<p>Loading...</p>';
            
            const moduleData = moduleRegistry.modules[moduleName];
            if (!moduleData) {
                return '<h2>Module not found</h2><p>The requested module does not exist.</p>';
            }
            
            const provider = getProviderFromModule(moduleName, moduleData.source);
            const registryPath = `my-unity-console.com/${moduleName.replace('-', '/')}/${provider}`;
            const readme = moduleReadmes[moduleName];
            
            let html = `
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 2rem;">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <button onclick="window.history.back()" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">‚Üê Back</button>
                        <h2 style="color: var(--unity-blue); font-size: 2rem; margin: 0;">${moduleName}</h2>
                    </div>
                    <button onclick="copyModuleMarkdown('${moduleName}', this)" style="background: var(--unity-blue); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">üìã Copy Markdown</button>
                </div>
                
                <p style="font-size: 1.125rem; margin-bottom: 2rem;">${moduleData.description}</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem;">
                        <strong>Registry Path:</strong><br>
                        <code style="font-size: 0.9rem;">${registryPath}</code>
                    </div>
                    <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem;">
                        <strong>Source:</strong><br>
                        <code style="font-size: 0.9rem;">${moduleData.source}</code>
                    </div>
                    ${moduleData.documentation ? `
                    <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem;">
                        <strong>Documentation:</strong><br>
                        <a href="${moduleData.documentation}" target="_blank" style="color: var(--unity-blue);">üìñ View README</a>
                    </div>
                    ` : ''}
                </div>
                
                <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Usage Example</h3>
                <p style="margin-bottom: 1rem;">Reference this module in your Terraform configuration:</p>
                
                <pre><code class="language-hcl">module "${moduleName.replace('unity-', '')}" {
  source  = "${registryPath}"
  version = "~> 1.0"
  
  # Required inputs${generateExampleInputs(moduleData.inputs)}
}</code></pre>
            `;
            
            // If we have README content, parse and display it
            if (readme) {
                const readmeHtml = parseReadmeContent(readme);
                html += `
                    <h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Module Documentation</h3>
                    <div style="background: #f9fafb; padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid var(--unity-blue);">
                        ${readmeHtml}
                    </div>
                `;
            }
            
            // Inputs from registry
            if (moduleData.inputs) {
                html += '<h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Inputs</h3>';
                html += '<div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">';
                html += '<tr style="background: #f8fafc;"><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Name</th><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Description</th><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Type</th><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Required</th><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Default</th></tr>';
                
                Object.entries(moduleData.inputs).forEach(([inputName, inputData]) => {
                    html += `
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;"><code>${inputName}</code></td>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;">${inputData.description}</td>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;"><code>${inputData.type}</code></td>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;">${inputData.required ? 'Yes' : 'No'}</td>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;">${inputData.default !== undefined ? `<code>${JSON.stringify(inputData.default)}</code>` : '-'}</td>
                        </tr>
                    `;
                });
                
                html += '</table></div>';
            }
            
            // Outputs from registry
            if (moduleData.outputs) {
                html += '<h3 style="color: var(--unity-blue); font-size: 1.5rem; margin: 2rem 0 1rem;">Outputs</h3>';
                html += '<div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">';
                html += '<tr style="background: #f8fafc;"><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Name</th><th style="text-align: left; padding: 0.75rem; border: 1px solid #e2e8f0;">Description</th></tr>';
                
                Object.entries(moduleData.outputs).forEach(([outputName, outputData]) => {
                    const description = typeof outputData === 'string' ? outputData : outputData.description;
                    html += `
                        <tr>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;"><code>${outputName}</code></td>
                            <td style="padding: 0.75rem; border: 1px solid #e2e8f0;">${description}</td>
                        </tr>
                    `;
                });
                
                html += '</table></div>';
            }
            
            return html;
        }
        
        // Generate example inputs for usage example
        function generateExampleInputs(inputs) {
            if (!inputs) return '';
            
            let examples = '';
            Object.entries(inputs).forEach(([name, input]) => {
                if (input.required) {
                    const exampleValue = getExampleValue(input.type, name);
                    examples += `\n  ${name} = ${exampleValue}`;
                }
            });
            
            return examples;
        }
        
        // Parse README content and convert to HTML
        function parseReadmeContent(readme) {
            // Simple markdown-to-HTML conversion for basic formatting
            let html = readme
                .replace(/^# (.+)$/gm, '<h4 style="color: var(--unity-blue); margin: 1.5rem 0 0.5rem;">$1</h4>')
                .replace(/^## (.+)$/gm, '<h5 style="color: var(--unity-gray-dark); margin: 1rem 0 0.5rem;">$1</h5>')
                .replace(/^### (.+)$/gm, '<h6 style="color: var(--unity-gray-dark); margin: 0.5rem 0;">$1</h6>')
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/`(.+?)`/g, '<code>$1</code>')
                .replace(/```(\w+)?\n([\s\S]*?)```/g, '<pre><code class="language-$1">$2</code></pre>')
                .replace(/\n/g, '<br>')
                .replace(/^- (.+)$/gm, '<li>$1</li>');
            
            // Wrap list items in ul tags
            html = html.replace(/(<li>.*<\/li>)/g, '<ul style="margin-left: 1.5rem;">$1</ul>');
            
            return html;
        }
        
        // Function to copy page markdown to clipboard
        function copyPageMarkdown(page, buttonElement) {
            const markdown = generatePageMarkdown(page);
            
            navigator.clipboard.writeText(markdown).then(() => {
                // Show temporary success message
                const originalText = buttonElement.textContent;
                buttonElement.textContent = '‚úÖ Copied!';
                buttonElement.style.background = '#059669';
                
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.style.background = 'var(--unity-blue)';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard. Please select and copy the text manually.');
            });
        }
        
        // Function to copy module-specific markdown
        function copyModuleMarkdown(moduleName, buttonElement) {
            const moduleData = moduleRegistry.modules[moduleName];
            const markdown = generatePageMarkdown(`module-${moduleName}`, moduleData);
            
            navigator.clipboard.writeText(markdown).then(() => {
                // Show temporary success message
                const originalText = buttonElement.textContent;
                buttonElement.textContent = '‚úÖ Copied!';
                buttonElement.style.background = '#059669';
                
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.style.background = 'var(--unity-blue)';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard. Please select and copy the text manually.');
            });
        }
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>